<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ì—­ìœ ì¹˜ì› ì±—ë´‡</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
            overflow: auto;
        }

        /* ì•„ì´ì½˜ ë²„íŠ¼ */
        #openChatBtn {
            position: fixed;
            bottom: 140px;
            right: 20px;
            background: #5c7cfa;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            z-index: 999;
            opacity: 0.4;
        }

        /* ì±—ë´‡ ì»¨í…Œì´ë„ˆ */
        #chatbotContainer {
            position: fixed;
            top: 0;
            right: -100%; /* ì´ˆê¸°ì—ëŠ” í™”ë©´ ì˜¤ë¥¸ìª½ì— ìˆ¨ê²¨ì§ (ëª¨ë°”ì¼) */
            width: 100%; /* ëª¨ë°”ì¼ì—ì„œ ì „ì²´ ë„ˆë¹„ */
            height: 100%; /* ëª¨ë°”ì¼ì—ì„œ ì „ì²´ ë†’ì´ */
            background: #FFCB00;
            box-shadow: -3px 0 10px rgba(0, 0, 0, 0.2);
            transition: right 0.3s ease, opacity 0.3s ease;
            z-index: 998;
            display: flex;
            flex-direction: column;
            padding: 0;
            opacity: 0;
        }

        /* ì±—ë´‡ì´ ì—´ë ¸ì„ ë•Œ */
        #chatbotContainer.open {
            right: 0;
            opacity: 1;
        }

        #chatbotContainer h2 {
            margin: 0;
            padding: 15px;
            font-size: 24px;
            color: #4e6cf1;
            text-align: center;
            background-color: #FFCB00;
            border-bottom: 1px solid #e0e0e0;
        }

        #chat {
            flex: 1;
            overflow-y: auto;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 0;
            margin-bottom: 0;
        }

        .input-container {
            display: flex;
            gap: 10px;
            padding: 10px;
            background-color: #fff;
            border-top: 1px solid #e0e0e0;
        }

        /* ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .message-row {
            display: flex;
            align-items: flex-end;
            margin-bottom: 30px;
        }

        .message-row.user {
            justify-content: flex-end;
        }

        .message-row.bot,
        .message-row.gemini {
            justify-content: flex-start;
        }

        .profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 8px;
            background-color: #ccc;
            flex-shrink: 0;
            background-size: cover;
            background-position: center;
        }

        .profile-img.user-profile {
            background-image: url('https://media.discordapp.net/attachments/1382988874070102207/1399616307061587978/c75c73e9f95e07c2.png?ex=6889a5c3&is=68885443&hm=c9990c4d03710a988dc1e71c1a65fb6dcc0609133d0f6c0b7a27053387e6665b&=&format=webp&quality=lossless');
        }

        .profile-img.bot-profile {
            background-image: url('https://media.discordapp.net/attachments/1382988874070102207/1399616307367776336/38292a9cc414d6ff.png?ex=6889a5c3&is=68885443&hm=194369575ea0706d85a9b83b83a82ba8b27f26a76cb7af30827557946bf5f969&=&format=webp&quality=lossless');
        }

        .profile-img.gemini-profile {
            background-image: url('https://it.wisc.edu/wp-content/uploads/Google-Gemini-1080x480-News-Image.jpg');
        }

        .message-content {
            display: flex;
            flex-direction: column;
        }

        .message-bubble {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }

        .message-row.user .message-bubble {
            background-color: #dbfef2;
            color: #333;
        }

        .message-row.bot .message-bubble {
            background-color: #cbec53;
            color: #333;
        }

        .message-row.gemini .message-bubble {
            background-color: Lavender;
            color: #333;
        }

        .message-time {
            font-size: 11px;
            color: #999;
            margin-top: 4px;
        }

        .message-row.user .message-time {
            margin-right: 8px;
            text-align: right;
        }

        .message-row.bot .message-time,
        .message-row.gemini .message-time {
            margin-left: 8px;
            text-align: left;
        }

        #userInput {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 30px;
            font-size: 14px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
            background-color: #fff;
            background-image: url('https://img.icons8.com/ios-glyphs/30/000000/edit--v1.png'); /* ì…ë ¥ í•„ë“œ ì•„ì´ì½˜ */
            background-repeat: no-repeat;
            background-position: 10px center;
            padding-left: 40px;
            outline: none;
            transition: all 0.2s ease-in-out;
        }

        #userInput:focus {
            box-shadow: 0 0 8px rgba(92, 124, 250, 0.6);
        }

        #sendBtn {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s ease;
            background-color: #a9b6f3; /* ì „ì†¡ ë²„íŠ¼ ê¸°ë³¸ ìƒ‰ìƒ */
            background-image: url('https://img.icons8.com/ios-glyphs/30/ffffff/paper-plane.png'); /* ì „ì†¡ ì•„ì´ì½˜ */
            background-repeat: no-repeat;
            background-position: center;
            background-size: 24px;
        }

        #sendBtn:hover {
            background-color: gray;
            background-blend-mode: multiply;
        }

        /* ë°ìŠ¤í¬í†±ì„ ìœ„í•œ ë¯¸ë””ì–´ ì¿¼ë¦¬ */
        @media (min-width: 768px) {
            #chatbotContainer {
                width: 400px; /* ë°ìŠ¤í¬í†±ì—ì„œ ê³ ì • ë„ˆë¹„ */
                right: -400px; /* ë°ìŠ¤í¬í†±ì—ì„œ í™”ë©´ ë°–ì— ìœ ì§€ */
            }

            #chatbotContainer.open {
                right: 0; /* ë°ìŠ¤í¬í†±ì—ì„œ ì˜¤ë¥¸ìª½ì—ì„œ ìŠ¬ë¼ì´ë“œ */
            }
        }
    </style>
</head>

<body>

    <button id="openChatBtn" aria-label="ì±—ë´‡ ì—´ê¸°">ğŸ’¬</button>

    <div id="chatbotContainer">
        <h2 id="title">
            <img src="https://media.discordapp.net/attachments/1382988874070102207/1399616307061587978/c75c73e9f95e07c2.png?ex=6889a5c3&is=68885443&hm=c9990c4d03710a988dc1e71c1a65fb6dcc0609133d0f6c0b7a27053387e6665b&=&format=webp&quality=lossless"
                alt="ë‚¨ìì•„ì´" style="vertical-align: middle; height: 30px;">
            ì§€ì—­ìœ ì¹˜ì› ì±—ë´‡
            <img src="https://media.discordapp.net/attachments/1382988874070102207/1399616307367776336/38292a9cc414d6ff.png?ex=6889a5c3&is=68885443&hm=194369575ea0706d85a9b83b83a82ba8b27f26a76cb7af30827557946bf5f969&=&format=webp&quality=lossless"
                alt="ì—¬ìì•„ì´" style="vertical-align: middle; height: 30px;">
        </h2>
        <div id="chat"></div>
        <div class="input-container">
            <input type="text" id="userInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" aria-label="ë©”ì‹œì§€ ì…ë ¥" />
            <button id="sendBtn" aria-label="ë©”ì‹œì§€ ì „ì†¡"></button>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const chatbotContainer = document.getElementById("chatbotContainer");
            const openChatBtn = document.getElementById("openChatBtn");
            const chat = document.getElementById("chat");
            const userInput = document.getElementById("userInput");
            const sendBtn = document.getElementById("sendBtn");

            // ì±—ë´‡ ê°€ì‹œì„± í† ê¸€
            openChatBtn.addEventListener("click", () => {
                chatbotContainer.classList.toggle("open");

                // ì±—ë´‡ì´ ì—´ë ¸ì„ ë•Œ ë³¸ë¬¸ ìŠ¤í¬ë¡¤ ë°©ì§€
                document.body.style.overflow = chatbotContainer.classList.contains("open") ? "hidden" : "auto";
            });

            // ë²„íŠ¼ í´ë¦­ ì‹œ ë©”ì‹œì§€ ì „ì†¡
            sendBtn.addEventListener("click", () => {
                const message = userInput.value.trim();
                if (message === "") return; // ë¹ˆ ë©”ì‹œì§€ëŠ” ì „ì†¡í•˜ì§€ ì•ŠìŒ

                appendMessage("ğŸ§‘ ì‚¬ìš©ì", message);
                respond(message);
                userInput.value = ""; // ì „ì†¡ í›„ ì…ë ¥ì°½ ë¹„ìš°ê¸°
            });

            // Enter í‚¤ ëˆ„ë¥´ë©´ ë©”ì‹œì§€ ì „ì†¡
            userInput.addEventListener("keyup", (event) => {
                if (event.key === "Enter") sendBtn.click();
            });

            /**
             * ì±„íŒ… ë””ìŠ¤í”Œë ˆì´ì— ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
             * @param {string} sender - ë°œì‹ ì ì‹ë³„ì (ì˜ˆ: "ğŸ§‘ ì‚¬ìš©ì", "ğŸ¤– ì±—ë´‡", "âœ¨ Gemini").
             * @param {string} text - ë©”ì‹œì§€ í…ìŠ¤íŠ¸.
             */
            function appendMessage(sender, text) {
                const messageRow = document.createElement("div");
                messageRow.classList.add("message-row");

                const profileImg = document.createElement("div");
                profileImg.classList.add("profile-img");

                if (sender === "ğŸ§‘ ì‚¬ìš©ì") {
                    messageRow.classList.add("user");
                    profileImg.classList.add("user-profile");
                } else if (sender === "ğŸ¤– ì±—ë´‡") {
                    messageRow.classList.add("bot");
                    profileImg.classList.add("bot-profile");
                } else if (sender === "âœ¨ Gemini") {
                    messageRow.classList.add("gemini");
                    profileImg.classList.add("gemini-profile");
                }

                const messageContent = document.createElement("div");
                messageContent.classList.add("message-content");

                const messageBubble = document.createElement("div");
                messageBubble.classList.add("message-bubble");
                messageBubble.textContent = text;

                const messageTime = document.createElement("div");
                messageTime.classList.add("message-time");
                const now = new Date();
                messageTime.textContent = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;

                if (sender === "ğŸ§‘ ì‚¬ìš©ì") {
                    messageContent.appendChild(messageBubble);
                    messageContent.appendChild(messageTime);
                    messageRow.appendChild(messageContent);
                    messageRow.appendChild(profileImg); // ì‚¬ìš©ì í”„ë¡œí•„ì€ ì˜¤ë¥¸ìª½ì—
                } else {
                    messageRow.appendChild(profileImg); // ë´‡/Gemini í”„ë¡œí•„ì€ ì™¼ìª½ì—
                    messageContent.appendChild(messageBubble);
                    messageContent.appendChild(messageTime);
                    messageRow.appendChild(messageContent);
                }

                chat.appendChild(messageRow);
                chat.scrollTop = chat.scrollHeight; // ìµœì‹  ë©”ì‹œì§€ë¡œ ìŠ¤í¬ë¡¤
            }

            /**
             * Gemini APIì— ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.
             * @param {string} message - Geminiì— ë³´ë‚¼ ì‚¬ìš©ì ë©”ì‹œì§€.
             */
            function askGeminiAPI(message) {
                const GEMINI_API_KEY = "AIzaSyCMO0Edup71uWOyMrkMON6dXm3AlaWm4zY"; // ì‹¤ì œ í‚¤ë¡œ êµì²´í•˜ì„¸ìš”
                const API_ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;

                fetch(API_ENDPOINT, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: message
                            }]
                        }]
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        const geminiReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "ë‹µë³€ì„ ì°¾ì§€ ëª»í–ˆì–´ìš” ğŸ˜…";
                        appendMessage("âœ¨ Gemini", geminiReply);
                    })
                    .catch(error => {
                        console.error("Gemini í†µì‹  ì˜¤ë¥˜:", error);
                        appendMessage("âœ¨ Gemini", "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                    });
            }

            /**
             * ì‚¬ìš©ì ë©”ì‹œì§€ì— ê¸°ë°˜í•˜ì—¬ ì‘ë‹µì„ Geminiì—ê²Œ ì§ˆë¬¸í•©ë‹ˆë‹¤.
             * @param {string} message - ì‚¬ìš©ì ì…ë ¥ ë©”ì‹œì§€.
             */
            function respond(message) {
                let response = "";

                if (message.trim() === "1") {
                    response = "ì†¡êµ¬ì˜ íŒ€ì¥ë‹˜";
                } else if (message.trim() === "2") {
                    response = "ê¹€ê²½ì‹ íŒ€ì›";
                } else if (message.trim() === "3") {
                    response = "ê¹€ìƒëª… íŒ€ì›";
                } else if (message.trim() === "4") {
                    response = "ê¹€í˜„ë¯¼ íŒ€ì›";
                } else if (message.trim() === "5") {
                    response = "ì¡°ë¯¼ì„œ íŒ€ì›";
                } else {
                    const askGemini = confirm("ì´ ì§ˆë¬¸ì€ ëª©ë¡ì— ì—†ì–´ìš”. Geminiì—ê²Œ ë¬¼ì–´ë³¼ê¹Œìš”?");
                    if (askGemini) {
                        askGeminiAPI(message);
                        return;
                    } else {
                        response = "ì•Œê² ìŠµë‹ˆë‹¤! ë‹¤ë¥¸ ì§ˆë¬¸ ìˆìœ¼ë©´ ì•Œë ¤ì£¼ì„¸ìš” ğŸ˜„";
                    }
                }

                appendMessage("ğŸ¤– ì±—ë´‡", response);
            }
        });
    </script>

</body>

</html>
